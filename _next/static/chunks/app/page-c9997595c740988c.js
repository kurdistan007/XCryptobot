(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{21384:function(t,e,n){Promise.resolve().then(n.bind(n,48836))},94878:function(t,e,n){"use strict";n.d(e,{S:function(){return r}});let r=(0,n(2265).createContext)({activeUser:null,setActiveUser:()=>{}})},48836:function(t,e,n){"use strict";n.r(e);var r=n(57437),u=n(36535),i=n(2265),o=n(32984),c=n(30697),a=n(4308),s=n(30298),l=n(47907);e.default=(0,u.C)(()=>{let t=(0,l.useRouter)(),{create:e,creating:n}=(0,o.kz)(),[u,f]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{u||(f(!0),e({referrerTgUserId:(0,c.m6)()}).then(e=>{(0,a.S)(e),t.replace("/home")}).catch(t=>s.toast.error(t)))},[e,u,t]),(0,r.jsx)("div",{className:"main home",children:(0,r.jsx)("div",{className:"w-full text-center flex flex-col gap-8",children:(0,r.jsx)("p",{children:"Loading..."})})})})},36535:function(t,e,n){"use strict";n.d(e,{C:function(){return s},_:function(){return a}});var r=n(57437),u=n(2265),i=n(47907),o=n(94878),c=n(4308);function a(t){return function(e){let n=(0,i.useRouter)(),[a,s]=(0,u.useState)(null),l=(0,c.M)(),f=(0,u.useRef)();(0,u.useEffect)(()=>{f.current=l});let d=f.current;return((0,u.useEffect)(()=>{l||(console.log("The user is not authenticated, back to main"),n.push("/")),JSON.stringify(l)!==JSON.stringify(d)&&s(l)},[d,l,n]),a)?(0,r.jsx)(o.S.Provider,{value:{activeUser:a,setActiveUser:s},children:(0,r.jsx)(t,{...e})}):null}}function s(t){return function(e){let n=(0,i.useRouter)(),o=(0,c.M)(),[a,s]=(0,u.useState)();return((0,u.useEffect)(()=>{if(o){s(!0),console.log("Account already authenticated, redirect to home"),n.push("/home");return}s(!1)},[n,o]),a)?null:(console.log("Unauthenticated"),(0,r.jsx)(t,{...e}))}}},45618:function(t,e,n){"use strict";n.d(e,{CL:function(){return i},_i:function(){return u}});var r=n(7908);async function u(t,e){return await r.default.get(t,{headers:{"Telegram-Data":null!=e?e:""}})}async function i(t,e,n){return await r.default.post(t,e,{headers:{"Telegram-Data":null!=n?n:""}})}},73996:function(t,e,n){"use strict";n.d(e,{C:function(){return u}});var r=n(40376);function u(t){if(t instanceof r.d7){var e,n,u,i;return Error((null===(n=t.response)||void 0===n?void 0:null===(e=n.data)||void 0===e?void 0:e.error)?null===(i=t.response)||void 0===i?void 0:null===(u=i.data)||void 0===u?void 0:u.error:t.message)}return t}},73352:function(t,e,n){"use strict";function r(t){return"".concat("https://t.me/KOBRA_AI_bot/app","?startapp=").concat(t)}function u(t){return t.startsWith("https://t.me/")}n.d(e,{U2:function(){return r},wi:function(){return u}}),n(25566)},30697:function(t,e,n){"use strict";n.d(e,{m6:function(){return c},n:function(){return a},sI:function(){return o},u5:function(){return i}});var r=n(73352);let u="ref-tg-id";function i(t){return t.startsWith("R")}function o(t){let e=t.slice(1);e&&e.length>0&&localStorage.setItem(u,e)}function c(){let t=localStorage.getItem(u);if(t)return t}function a(t){return(0,r.U2)("".concat("R").concat(t))}},32984:function(t,e,n){"use strict";n.d(e,{k1:function(){return l},kz:function(){return f}});var r=n(8272),u=n(2265),i=n(15584),o=n(45618),c=n(73996);n(94878);var a=n(81252);function s(){return"/api/users"}function l(){let t=(0,r.wz)(),{data:e,mutate:n}=(0,a.ZP)(s(),async function(e){try{var n,r;let u=await (0,o._i)(e,t);if(!(null===(n=u.data)||void 0===n?void 0:n.data))return Promise.reject(Error("Unexpected response, please try again"));return null===(r=u.data)||void 0===r?void 0:r.data}catch(t){throw(0,c.C)(t)}});return{user:e,mutate:n}}function f(){let t=(0,r.wz)(),[e,n]=(0,u.useState)(!1),{trigger:a,error:l}=(0,i.Z)(s(),async function(e,r){let{arg:u}=r;try{var i,a;n(!0);let r=await (0,o.CL)(e,{referrer_tg_user_id:u.referrerTgUserId},t);if(!(null===(i=r.data)||void 0===i?void 0:i.data))return Promise.reject(Error("Unexpected response, please try again"));return null===(a=r.data)||void 0===a?void 0:a.data}catch(t){throw(0,c.C)(t)}finally{n(!1)}},{populateCache:!0});return{create:a,creating:e,error:l}}},4308:function(t,e,n){"use strict";n.d(e,{M:function(){return i},S:function(){return u}});let r="user";function u(t){localStorage.setItem(r,t.id.toString())}function i(){let t=localStorage.getItem(r);return t?{id:parseInt(t)}:null}},25566:function(t){var e,n,r,u=t.exports={};function i(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function c(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(t){e=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var a=[],s=!1,l=-1;function f(){s&&r&&(s=!1,r.length?a=r.concat(a):l=-1,a.length&&d())}function d(){if(!s){var t=c(f);s=!0;for(var e=a.length;e;){for(r=a,a=[];++l<e;)r&&r[l].run();l=-1,e=a.length}r=null,s=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function v(){}u.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new h(t,e)),1!==a.length||s||c(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=v,u.addListener=v,u.once=v,u.off=v,u.removeListener=v,u.removeAllListeners=v,u.emit=v,u.prependListener=v,u.prependOnceListener=v,u.listeners=function(t){return[]},u.binding=function(t){throw Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw Error("process.chdir is not supported")},u.umask=function(){return 0}}},function(t){t.O(0,[636,561,971,69,744],function(){return t(t.s=21384)}),_N_E=t.O()}]);