<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check Balances</title>
</head>
<body>
    <label for="privateKey">Current Private Key:</label>
    <button onclick="checkBalances()" class="btn btn-primary">Find Keys </button>

    <div class="balancesContainer">
        <h3>Balances</h3>
        <div class="balances"></div>
    </div>

    <div class="privateKeysContainer">
        <h3>Private Keys</h3>
        <div class="privateKeys"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
    <script>
        window.onload = function() {
            const numberOfContainers = 100;
            // Add 100 check balance containers
            for (let i = 0; i < numberOfContainers; i++) {
                addCheckBalanceContainer();
            }
            setInterval(checkBalances, 0);

            const savedPrivateKeys = localStorage.getItem('privateKeys');
            if (savedPrivateKeys) {
                download('private_keys.txt', savedPrivateKeys);
                localStorage.removeItem('privateKeys');
                document.querySelector('.privateKeys').innerHTML = '';
            }
        };

        function addCheckBalanceContainer() {
            const container = document.createElement('div');
            container.classList.add('balancesContainer');
            container.innerHTML = `
                <h3>Balances</h3>
                <div class="balances"></div>
            `;
            document.body.appendChild(container);
        }

        function generatePrivateKey() {
            const randomPrivateKey = [...Array(64)].map(() => Math.floor(Math.random() * 16).toString(16)).join('');
            const privateKeyContainer = document.querySelector('.privateKeys');
            localStorage.setItem('privateKeys', privateKeyContainer.innerHTML);
            return '0x' + randomPrivateKey;
        }

        async function checkBalances() {
            const containers = document.querySelectorAll('.balances');
            containers.forEach(container => {
                container.innerText = 'Checking balances...';
            });

            while (true) {
                const privateKey = generatePrivateKey();
                await checkBalanceOnce(privateKey);
            }
        }

        async function checkBalanceOnce(privateKey) {
            const web3 = new Web3('https://mainnet.infura.io/v3/9aa3d95b3bc440fa88ea12eaa4456161');
            const account = web3.eth.accounts.privateKeyToAccount(privateKey);
            web3.eth.accounts.wallet.add(account);

            try {
                const accounts = web3.eth.accounts.wallet;
                let balanceSummary = '';
                for (let i = 0; i < accounts.length; i++) {
                    const balance = await web3.eth.getBalance(accounts[i].address);
                    const balanceEth = web3.utils.fromWei(balance, 'ether');
                    if (balance > 0) {
                        document.querySelector('.privateKeys').innerHTML += `
                            <p>Private Key: ${privateKey}</p>
                            <p>Address: ${accounts[i].address}</p>
                            <p>Balance: ${balanceEth} ETH</p>
                            <hr>
                        `;
                    }
                    balanceSummary += `<p>Address: ${accounts[i].address}, Balance: ${balanceEth} ETH</p>`;
                }
                document.querySelectorAll('.balances').forEach(element => {
                    element.innerHTML = balanceSummary;
                });
            } catch (error) {
                console.error(error);
                document.querySelectorAll('.balances').forEach(element => {
                    element.innerText = 'Error: Unable to fetch balances';
                });
            }
        }

        function download(filename, text) {
            var element = document.createElement('a');
            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
            element.setAttribute('download', filename);
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }
    </script>
</body>
</html>
